syntax = "proto3";

package service.scene;

import "attributes/scene.proto";
import "attributes/combat.proto";


message RequestPreEnterScene{
  message Response{
    int32 error_code = 1;
    attributes.scene.SceneInfo scene_info = 2;
  }
}

message RequestEnterDefaultScene {
  message Response {
    int32 error_code = 1;
    attributes.scene.EntitySceneInfo entity_scene_info = 2;
    attributes.scene.SceneInfo scene_info = 3;
  }
}

message RequestEnterScene {
  int32 scene_id = 1;
  int32 scene_gid = 2;

  message Response {
    int32 error_code = 1;
    int64 uid = 2;
    attributes.scene.SceneInfo scene_info = 3;
  }
}

message RequestMove {
  int32 direction = 1;
  bool stop_move = 2;
  message Response {
    int64 global_id = 1;
    attributes.scene.Position position = 2;
  }
}

message RequestUpdatePos{
  attributes.scene.Position pos = 1;
  message Response{
    attributes.scene.SceneInfo scene_info = 1;
    int64 uid = 2;
  }
}

message RequestUseSkill {
  int32 skill_id = 1;
  message Response {
    int64 dest_gid = 1;
    int64 target_gid = 2;
    int32 skill_id = 3;
    int32 damage = 4;
    bool is_critical = 5;
    int32 cur_hp = 6;
  }

  message ResponsePos{
    int64 global_id = 1;
    int32 skill_id = 2;
    int64 global_skill_id = 3;
    attributes.scene.Position pos = 4;
  }
}

message RequestGetScenePlayers{
  message Response{
    int32 scene_id = 1;
    int32 scene_gid = 2;
    int32 player_count = 3;
    repeated attributes.scene.PlayerSceneInfo players = 4;
  }
}

message RequestLeaveScene{
  message Response{
  }
}

message RequestFightInfo{
  int64 uid = 1;
  message Response{
    int64 uid = 1;
    attributes.combat.FightInfo fight_info = 2;
  }
}

message RequestPathFind{
  int32 x = 1;
  int32 z = 2;
}


message ResponseUpdateView{
  repeated attributes.scene.EntitySceneInfo in_view_entities = 1;
  repeated attributes.scene.EntitySceneInfo out_view_entities = 2;
}

message ResponseLeaveView{
  int64 global_id = 1;
}

message ResponseEnterView{
  attributes.scene.EntitySceneInfo in_view_entity = 1;
}

message ResponseUpdateNpcView{
  repeated attributes.scene.EntitySceneInfo leave_npcs = 1;
  repeated attributes.scene.EntitySceneInfo enter_npcs = 2;
  repeated attributes.scene.EntitySceneInfo update_npcs = 3;
}

message RequestReborn{
  int32 type = 1;
  message Response{
    int32 error_code = 1;
    int32 cur_hp = 2;
  }
}


message ResponseUpdateBuff{
  int32 buff_id = 1;
  bool is_add = 2;
  int64 global_id = 3;
}